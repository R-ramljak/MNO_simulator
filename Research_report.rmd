---
title: "Research Report"
author: "Marco Ramljak"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_notebook: default
  word_document: default
---

# Introduction

Data generated by the cellular network of a mobile network operator (MNO) represent a rich potential source for estimating the spatial distribution of mobile phones at some given time and, from there, gain insight into the temporal variations of the spatial distribution of humans -- relevant for applications in, e.g., demography, tourism statistics and urban planning. The processing pipeline from raw MNO data to the final spatial density map requires modeling the (approximate) spatial footprint of individual radio cells -- a task called "cell geo-location". Some recent work has shown that, with appropriate estimation methods based on stochastic models, the availability of more detailed cell footprint information allows to improve considerably the spatial accuracy of the final estimate compared with the simpler traditional methods relying on Voronoi tessellations. However, such results were obtained (i) under the assumption of perfect cell footprint knowledge and (ii) limited to a single scenario characterized by a dense multi-layer radio coverage pattern with high degree of cell overlapping.

In the present follow-up work we conduct an extensive sensitivity analysis of all state-of-the-art estimation strategies containing different cell geo-location methods. We investigate the sensitivity of estimation accuracy (i) to uncertainties in cell footprint modeling due to imperfect knowledge of the radio propagation environment and (ii) to various scenario parameters concerning the radio coverage pattern (e.g. cell size, density, degree of overlapping). Furthermore, we scrutnize the importance of the necessary prior concerning its relation between informativeness and the rate of improvement in terms of spatial accuracy.

Owing to the spatial nature of the estimation problem, we use the Kantorovich-Wasserstein distance to measure the (dis)similarity between the estimated density and the true population distribution.

-   *Mention multiple studies that use MNO data for population density estimation*

-   *Mention Fabios and Martijns work on this topic*

-   *Mention Dynamic (considering time dimension) vs. Static (this one) approach*

-   *Mention Ogulenko, KÃ¶bele, etc. work*

# Theory

## Definitions

1.  Tiles ($j$)

2.  Radio cells ($i$)

3.  Geo-location:

    -   Tesselation --\> Deterministic

    -   Overlapping cells --\> Probabilistic

        -   Emission probabilities ($p_{ij}$)

4.  Formalize the estimation task

## Estimation Methods

1.  **Voronoi (Deterministic)**

    1.  Formula: $\hat{u}_{j} = \frac{c_{i}} {A_{i}}$

        where $\hat{u}_{j}$ represents the tile specific estimate, $c_{i}$ the cell specific number of registered cell phones and $A_{i}$ the size of the cell specific area. If a tile intersects with multiple Voronoi regions (not because of overlap but because the Voronoi coordinate system does not have to be aligned with the regular grid) a weighted average based on the sizes of the intersections.

        -   In case of implementing a prior: $\hat{u}_{j}^{(n)} = \frac{w^{(n)}c_{i}} {\sum_{k = 1}^{K}w^{(k)}A_{i}}$

    2.  Logic: Seed points are projected to the focus area and each point in the area is classified with its closest seed. By definition, no overlapping cells nor holes can be modeled. The inherent assumption is that each phone is connected to its closest cell.

    3.  Further notes:

        1.  Seed options

            -   Seed: Tower (with prior)
            -   Seed: Antenna offset (with prior)
            -   Seed: Antenna barycenter (with prior)

        2.  In this work we introduce for the first time a Voronoi estimation option, which is able to implement a prior. Each seed option is compatible. In the usual case without a prior (or in the case of a uniform prior) the number of cell phones of a cell specific Voronoi region is equally distributed to its area. Implementing a prior can differentiate areas within a Voronoi region and distribute the number of cell phones based on the prior ratios.

2.  **Simple Bayes (Probabilistic)**

    1.  Formula: $\hat{u}^{m+1}_{j} = a_{j} * \sum_{i = 1}^{I} c_{i} \frac{p_{ij}} {\sum_{k=1}^{J} p_{ik} a_{k}}$

    2.  Logic: Direct computation based on Bayes rule

    3.  Further notes:

3.  **MLE/EM (Probabilistic)**

    1.  Formula: $\hat{u}^{m+1}_{j} = \hat{u}^{m}_{j} * \sum_{i = 1}^{I} c_{i} \frac{p_{ij}} {\sum_{k=1}^{J} p_{ik} \hat{u}^{m}_{k}}$

    2.  Logic: Hierarchical generative model where the elements of $u$ are modeled as Poisson random variables. MLE is computed iteratively via EM-algorithm.

    3.  Further notes:

        1.  Mention that MLE and Poisson have the same outcome (Fabio and Angelos paper)

        2.  Very similar to Simple Bayes estimator.

4.  **DF approximation (Probabilistic)**

    1.  Formula: $\hat{u} := max(AP^{T} (PAP)^{-1} (c-Pa)+a; 0)$ maximum intended element-wise

    2.  Logic: Estimating via maximum likelihood a number of candidate estimates that fit best based on the emission probabilities and choosing the one that fits best with a set prior vector.

    3.  Further notes:

        1.  The importance of supertiles

## Prior knowledge

Using prior information results from the Bayesian Statistics framework gives the opportunity of considering prior beliefs/information into the final estimate. However, the prime motivation for implementing prior information here is to reduce the issue of non-identifiability of the estimation task at hand.

The prior distribution should always be related to the high-level estimation task one is encountering. I.e. if one is interested in general census-like estimates for example, the specification of a prior distribution most certainly would look different than if one is interested in measuring the day-time population of a particular holiday.

*Mention Weight of the prior compared to the weight of the data on the final estimate distribution.*

*Mention work of Tennekes and Gootzen on prior development*

1.  Uniform prior (Uninformative)
2.  Mildly informative prior (3 classes, quantized from the GTP)

## Sensitivity towards cell coverage model mismatch

Probabilistic estimators are able to implement much more information concerning the actual coverage of the cells, meaning, they allow for flexible radio propagation modelling. This flexibility is not given with deterministic estimators. Previous research has shown that probabilistic estimators perform better in terms of spatial accuracy than deterministic estimators, however, assuming that perfect cell coverage information is available. Perfect cell coverage information is never available, as there are many parameters to be considered, some of them very difficult/impossible to measure. *[Mention examples of parameters]*. The question arises, how good these estimators perform, when only an approximation of the accurate coverage information is available?

We assume that the spatial accuracy of the estimate derived from a probabilistic estimator is positively related to the level of quality of the coverage information implemented.

*Try to mention all relevant cell characteristics that are relevant for cell coverage modelling and rate them in terms of ease of accurate measurement (quality) and ease of availability.*

## Robustness towards network structure (scenarios)

1.  Antenna density

    -   Sparse network --\> low overlap
    -   Dense network --\> high overlap

2.  Layering --\> differing distance-to-dominance ratios

    -   Two layer network
    -   Three layer network

## Research Questions

**RQ1: How robust are estimation strategies to network model mismatching errors (information quality)?**

**RQ2: How sensitive are estimation strategies to network characteristics, such as cell density or differing cell layers?**

Varying the coverage information quality within probabilistic estimators will reveal the estimators' sensitivity to imperfect cell coverage information. Varying the network characteristics through different toyworlds will increase the final performance results' robustness as well as give an indication of the necessary quality degree of cell coverage information when comparing probabilistic estimators to deterministic estimators.

# Methods

## MNO simulator

1.  Simulation study

2.  Workflow:

    -   Toyworld Generation
    -   Estimation
    -   Evaluation

## Data sources and simulations:

1.  Gridded area data with population values (Munich and surroundings): German census

    ![](workflow_objects/pop.png){width="10cm"}

2.  Network data: simulated via `mobloc`

    -   Cell density and overlap

    -   Cell Layers

    -   Signal Strength and Signal dominance

    -   Distance-to-dominance ratios

    -   Different scenarios

## Introduction of model mismatch strategy

### Spatially sensitive random noise

We take the signal strength (measured in dBm) as a basis and introduce random noise sampled from a uniform distribution with variable min-max values (e.g. min: -3; max: 3). The most extreme case is -21 and 21. Each sampled value is added (or subtracted) to the true dBm value of the cell profile. This mismatch technique resembles for example the signal strength volatility through weather conditions. This random noise is introduced in a spatially sensitive way, meaning cell coverage profiles are not completely spatially distorted but only "around" the original cell coverage profile in a realistic way. Cell coverage direction is retained as this can be classified as secure knowledge. Distorted signal strength values are transformed to signal dominance values in the usual way and through the minimum signal dominance threshold, "holes" (as seen in the figure below") are possible.

![](workflow_objects/noise.dom.plot.ME.png){width="10cm"}

### Quantization

For this mismatch technique we basically quantize, i.e. discretize, the smooth signal dominance values into a defined number of categories. The number of categories is the variable parameter (2\^n). For example in the most extreme case, the complete true coverage values on the signal dominance scale is discretized into one 1 category - the complete coverage area has a uniform signal strength / signal dominance. This mismatch technique can resemble different levels of quality for cell coverage data - a realistic situation is if one only has access to the location, the direction and an approximate power level of the cells.

![](workflow_objects/quant.dom.plot.ME.w.th.png){width="10cm"}

![](workflow_objects//theo.quant.plot.png){width="10cm"}

## Development of priors

1.  Uniform prior

    -   Each tile receives a prior value of 1.

2.  Mildly informative prior

    -   We quantize the ground truth population ([0-1]; [2-50]; [\>51] into 3 discrete classes (0.1; 1; 100) respectively. The values of these discrete classes are used as a prior values for each tile respectively.

## KWD

Concerning spatial density accuracy, the central question we ask ourselves in our experiments is: how similar is our estimation to the ground truth? A first step to evaluate this question is to plot maps of the estimations' spatial density and compare it visually to the ground truth spatial density. However, this is merely a visual metric, not returning any objective measurement to properly assess the similarity.

For quantitatively measuring the similarity between two spatial density maps, we need to account for the spatial nature of the analysis problem. Therefore, we resort to the Kantorovitch Wasserstein Distance (KWD), which was also used in previous work concerning the accuracy of spatial density estimates. For computing the KWD we use the R-package of Prof. Stefano Gualandi \`SpatialKWD\`. This package is the result of the article that is referenced [here]([https://epubs.siam.org/doi/abs/10.1137/19M1261195?casa_token=f2nek1tmXtgAAAAA%3AkuwTSnCg8ETBNBiazggdPcqxBycf05v94Bs1rbadLETmMgk5o5Q7_DxTIz15WYxPcVWgv2vrwQ&),](https://epubs.siam.org/doi/abs/10.1137/19M1261195?casa_token=f2nek1tmXtgAAAAA%3AkuwTSnCg8ETBNBiazggdPcqxBycf05v94Bs1rbadLETmMgk5o5Q7_DxTIz15WYxPcVWgv2vrwQ&),) which develops a computationally efficient approximation method of the KWD. The tunable integer parameter L balances the computational resources with the KWD's estimation accuracy. For this approximation parameter we use \`L = 2\`, which basically means that the approximation error will be in the worst case 2.68%. The output value is used as an upper bound for the KWD estimate and the worst case adjustment acts as a lower bound.

As indicated in the section describing the estimation methods, the properties of each estimator assure that the same mass (i.e. mobile phones/population units) as the ground truth mass is being distributed over the area. By means of KWD we primarily asses if this mass is distributed in the same way over the area as the geographical distribution of the ground truth - and if not, how far any population unit needs to travel on average, in terms of 100m\\\*100m tiles. Therefore, high KWD values are associated with a highly dissimilar distribution and low KWD values are associated with a highly similar distribution compared to the ground truth.

## Analysis plan

-   *(The following will be also contained into a graphic or flowchart)*

-   For the same area with the same population values per tile, we created 4 different networks (scenarios) differing in cell density and the number of layers.

-   We use the generative model information concerning the cell coverage to create mismatched models for the estimation phase.

-   We run all probabilistic estimation strategies with all (mismatch) models and prior specifications to receive the respective final estimation distribution. We also run all deterministic estimation strategies with all prior specifications as a benchmark.

-   Each final estimation distribution is quantitatively evaluated by means of KWD. We are interested in the estimate distributions with the lowest KWD values.

    -   From previous research we know that numerical estimators, which utilize maximum cell footprint information for modelling, yield lower KWD values than for example Voronoi estimators. However, such results were obtained (i) under the assumption of perfect cell footprint knowledge and (ii) limited to a single scenario characterized by a dense multi-layer radio coverage pattern with high degree of cell overlapping. Therefore, in operational terms, we are interested (i) in what way the quality of cell footprint knowledge, as well as (ii) the network characteristics, i.e., the number of layers and the degree of overlap, influences the KWD value of the numerical estimators.

-   Further relevant statistics are calculated, which asses for example the convergence of numerical estimation strategies.

# Results

1.  Mismatch (RQ1)

    ![](Poster/kwd.noise.plot.png){width="10cm"}

    -   Even with severe model mismatch, probabilistic estimators lead always to spatially more accurate results than any Voronoi estimator. *(The figure above shows only the results for the noise mismatch technique and for the dense and sparse network)*

2.  Scenarios

    -   Higher network density offers more information and can therefore lead to spatially more accurate results than sparse networks. Probabilistic estimators utilize this information better than Voronoi estimators.

    -   *Mention quantization results*

    -   *Mention results concerning multiple network layers*

3.  Priors

    -   *Mention Rate of performance increase per estimator with a mildly informative prior*

4.  Further interesting results / observations

    1.  Computation speed

        1.  Supertiles

        2.  Convergence

    2.  Divergence with highly quantized models

# Discussion / Conclusion

This research project scrutinizes the trade-off between spatial estimation accuracy and model parsimony, concerning the task of deriving mobile phone density from MNO data. One could argue that Voronoi estimators, i.e. deterministic estimators, represent a parsimonious estimator, however, these estimation strategies (1) are based on a faulty assumption (mobile phones always connect to its closest cell), and (2) entail the unusual and unwanted barrier of an information implementation barrier. Therefore, they offer limited flexibility in modelling cell coverage profiles, even if further useful information would be available. With probabilistic estimators on the other hand, all relevant available information concerning cell coverage modelling can be implemented/used and these estimators entail the logical modelling property of improved performance through better/more information.

Concluding from our sensitivity analysis results, we argue that a Voronoi estimator should only be chosen when no cell coverage (cellplan) information is available, just merely the tower (base station) locations. However, whenever the antenna information on their propagation direction and power is available, a probabilistic estimator is advisable.

# References
